


<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title> | </title>

        <link rel="stylesheet" href="/css/style.css">
        <link rel="stylesheet" href="/css/highlight.css">
        <link rel='stylesheet' href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800'>

        <!-- Font Awesome -->
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <!-- Fetch JQuery from CDN but have a local fallback -->
        <script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script>
            if (typeof jQuery == 'undefined') {
                document.write(unescape("%3Cscript src='/jquery.js'%3E%3C/script%3E"));
            }
        </script>
    </head>
    <body>
        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme = localStorage.getItem('theme');
            if (theme == null) { theme = 'light'; }
            $('body').removeClass().addClass(theme);
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = localStorage.getItem('sidebar');
            if (sidebar === "hidden") { $("html").addClass("sidebar-hidden") }
            else if (sidebar === "visible") { $("html").addClass("sidebar-visible") }
        </script>

        <div id="sidebar" class="sidebar">
            <ul class="chapter">

              
              <li>
                <a href="#about-this-book.html"> About This Book</a>
              </li>
              
              <li>
                <a href="#language.html"> Language Structure</a>
              </li>
              
              <li>
                <a href="#builtin.html"> Built-in Classes</a>
              </li>
              
              <li>
                <a href="#stdlib.html"> Standard Library</a>
              </li>
              
              <li>
                <a href="#advanced-topics.html"> Advanced Topics</a>
              </li>
              

            </ul>
        </div>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar" class="menu-bar">
                    <div class="left-buttons">
                        <i id="sidebar-toggle" class="fa fa-bars"></i>
                        <i id="theme-toggle" class="fa fa-paint-brush"></i>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <i id="print-button" class="fa fa-print" title="Print this book"></i>
                    </div>
                </div>

                 
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">require</span> <span class="s1">'net/imap'</span>
</code></pre></div></div>

<h1 id="netimap">Net::IMAP</h1>

<p>Net::IMAP implements Internet Message Access Protocol (IMAP) client
functionality. The protocol is described in [IMAP].</p>

<h2 id="imap-overview">IMAP Overview</h2>

<p>An IMAP client connects to a server, and then authenticates itself using
either <code class="highlighter-rouge">#authenticate</code>() or <code class="highlighter-rouge">#login</code>(). Having authenticated itself,
there is a range of commands available to it. Most work with mailboxes,
which may be arranged in an hierarchical namespace, and each of which
contains zero or more messages. How this is implemented on the server is
implementation-dependent; on a UNIX server, it will frequently be
implemented as files in mailbox format within a hierarchy of
directories.</p>

<p>To work on the messages within a mailbox, the client must first select
that mailbox, using either <code class="highlighter-rouge">#select</code>() or (for read-only access)
<code class="highlighter-rouge">#examine</code>(). Once the client has successfully selected a mailbox, they
enter <em>selected</em> state, and that mailbox becomes the <em>current</em> mailbox,
on which mail-item related commands implicitly operate.</p>

<p>Messages have two sorts of identifiers: message sequence numbers and
UIDs.</p>

<p>Message sequence numbers number messages within a mailbox from 1 up to
the number of items in the mailbox. If a new message arrives during a
session, it receives a sequence number equal to the new size of the
mailbox. If messages are expunged from the mailbox, remaining messages
have their sequence numbers “shuffled down” to fill the gaps.</p>

<p>UIDs, on the other hand, are permanently guaranteed not to identify
another message within the same mailbox, even if the existing message is
deleted. UIDs are required to be assigned in ascending (but not
necessarily sequential) order within a mailbox; this means that if a
non-IMAP client rearranges the order of mailitems within a mailbox, the
UIDs have to be reassigned. An IMAP client thus cannot rearrange message
orders.</p>

<h2 id="examples-of-usage">Examples of Usage</h2>

<h3 id="list-sender-and-subject-of-all-recent-messages-in-the-default-mailbox">List sender and subject of all recent messages in the default mailbox</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">imap</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">IMAP</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'mail.example.com'</span><span class="p">)</span>
<span class="n">imap</span><span class="p">.</span><span class="nf">authenticate</span><span class="p">(</span><span class="s1">'LOGIN'</span><span class="p">,</span> <span class="s1">'joe_user'</span><span class="p">,</span> <span class="s1">'joes_password'</span><span class="p">)</span>
<span class="n">imap</span><span class="p">.</span><span class="nf">examine</span><span class="p">(</span><span class="s1">'INBOX'</span><span class="p">)</span>
<span class="n">imap</span><span class="p">.</span><span class="nf">search</span><span class="p">([</span><span class="s2">"RECENT"</span><span class="p">]).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">message_id</span><span class="o">|</span>
  <span class="n">envelope</span> <span class="o">=</span> <span class="n">imap</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="n">message_id</span><span class="p">,</span> <span class="s2">"ENVELOPE"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nf">attr</span><span class="p">[</span><span class="s2">"ENVELOPE"</span><span class="p">]</span>
  <span class="nb">puts</span> <span class="s2">"</span><span class="si">#{</span><span class="n">envelope</span><span class="p">.</span><span class="nf">from</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">name</span><span class="si">}</span><span class="s2">: </span><span class="se">\t</span><span class="si">#{</span><span class="n">envelope</span><span class="p">.</span><span class="nf">subject</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span>
</code></pre></div></div>

<h3 id="move-all-messages-from-april-2003-from-mailsent-mail-to-mailsent-apr03">Move all messages from April 2003 from “Mail/sent-mail” to “Mail/sent-apr03”</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">imap</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">IMAP</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'mail.example.com'</span><span class="p">)</span>
<span class="n">imap</span><span class="p">.</span><span class="nf">authenticate</span><span class="p">(</span><span class="s1">'LOGIN'</span><span class="p">,</span> <span class="s1">'joe_user'</span><span class="p">,</span> <span class="s1">'joes_password'</span><span class="p">)</span>
<span class="n">imap</span><span class="p">.</span><span class="nf">select</span><span class="p">(</span><span class="s1">'Mail/sent-mail'</span><span class="p">)</span>
<span class="k">if</span> <span class="n">not</span> <span class="n">imap</span><span class="p">.</span><span class="nf">list</span><span class="p">(</span><span class="s1">'Mail/'</span><span class="p">,</span> <span class="s1">'sent-apr03'</span><span class="p">)</span>
  <span class="n">imap</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="s1">'Mail/sent-apr03'</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">imap</span><span class="p">.</span><span class="nf">search</span><span class="p">([</span><span class="s2">"BEFORE"</span><span class="p">,</span> <span class="s2">"30-Apr-2003"</span><span class="p">,</span> <span class="s2">"SINCE"</span><span class="p">,</span> <span class="s2">"1-Apr-2003"</span><span class="p">]).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">message_id</span><span class="o">|</span>
  <span class="n">imap</span><span class="p">.</span><span class="nf">copy</span><span class="p">(</span><span class="n">message_id</span><span class="p">,</span> <span class="s2">"Mail/sent-apr03"</span><span class="p">)</span>
  <span class="n">imap</span><span class="p">.</span><span class="nf">store</span><span class="p">(</span><span class="n">message_id</span><span class="p">,</span> <span class="s2">"+FLAGS"</span><span class="p">,</span> <span class="p">[</span><span class="ss">:Deleted</span><span class="p">])</span>
<span class="k">end</span>
<span class="n">imap</span><span class="p">.</span><span class="nf">expunge</span>
</code></pre></div></div>

<h2 id="thread-safety">Thread Safety</h2>

<p>Net::IMAP supports concurrent threads. For example,</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">imap</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">IMAP</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"imap.foo.net"</span><span class="p">,</span> <span class="s2">"imap2"</span><span class="p">)</span>
<span class="n">imap</span><span class="p">.</span><span class="nf">authenticate</span><span class="p">(</span><span class="s2">"cram-md5"</span><span class="p">,</span> <span class="s2">"bar"</span><span class="p">,</span> <span class="s2">"password"</span><span class="p">)</span>
<span class="n">imap</span><span class="p">.</span><span class="nf">select</span><span class="p">(</span><span class="s2">"inbox"</span><span class="p">)</span>
<span class="n">fetch_thread</span> <span class="o">=</span> <span class="no">Thread</span><span class="p">.</span><span class="nf">start</span> <span class="p">{</span> <span class="n">imap</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="mi">1</span><span class="o">..-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"UID"</span><span class="p">)</span> <span class="p">}</span>
<span class="n">search_result</span> <span class="o">=</span> <span class="n">imap</span><span class="p">.</span><span class="nf">search</span><span class="p">([</span><span class="s2">"BODY"</span><span class="p">,</span> <span class="s2">"hello"</span><span class="p">])</span>
<span class="n">fetch_result</span> <span class="o">=</span> <span class="n">fetch_thread</span><span class="p">.</span><span class="nf">value</span>
<span class="n">imap</span><span class="p">.</span><span class="nf">disconnect</span>
</code></pre></div></div>

<p>This script invokes the FETCH command and the SEARCH command
concurrently.</p>

<p><a href="https://ruby-doc.org/stdlib-2.5.0/libdoc/net/imap/rdoc/Net::IMAP.html">Net::IMAP
Reference</a></p>



                <!-- Mobile navigation buttons -->


                <!--
                    <a href="cli/cli-tool.html" class="mobile-nav-chapters next">
                        <i class="fa fa-angle-right"></i>
                    </a>
                 -->

            </div>



               <!--
                <a href="cli/cli-tool.html" class="nav-chapters next" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-right"></i>
                </a>
                 -->

        </div>


        <script src="js/book.js"></script>
    </body>
</html>
